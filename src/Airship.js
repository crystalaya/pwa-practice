import React, { useRef, useEffect } from "react";
import styled from "styled-components";

const SHIP_SVG =
  "M44.1 52.8c0-.1.1-.1.1-.1.1 0 .1.1.1.1 0 .1-.1.1-.1.1l-.1-.1zm-.8 0c0 .5.4.9.9.9s.9-.4.9-.9-.4-.9-.9-.9c-.5-.1-.9.4-.9.9zm-1.6-38.5c-.1-.4-.4-.6-.8-.5-.4.1-.6.4-.5.8.1.4.4.6.8.5.3-.1.6-.4.5-.8zm4.6 38.5c0-.1.1-.1.1-.1l.1.1c0 .1-.1.1-.1.1l-.1-.1zm-.8 0c0 .5.4.9.9.9s.9-.4.9-.9-.4-.9-.9-.9-.9.4-.9.9zm-20-25.9c0 .4.3.7.7.7.4 0 .7-.3.7-.7 0-.4-.3-.7-.7-.7-.4.1-.7.4-.7.7zm.3 3.1c0 .4.3.7.7.7.4 0 .7-.3.7-.7s-.3-.7-.7-.7c-.4.1-.7.4-.7.7zm.4 3.2c0 .4.3.7.7.7.4 0 .7-.3.7-.7 0-.4-.3-.7-.7-.7-.4 0-.7.3-.7.7zM42 17.4c-.1-.4-.4-.6-.8-.5-.4.1-.6.4-.5.8.1.4.4.6.8.5.4 0 .6-.4.5-.8zm.4 3.2c-.1-.4-.4-.6-.8-.5-.4.1-.6.4-.5.8.1.4.4.6.8.5.3-.1.5-.5.5-.8zm1 9.3c-.1-.4-.4-.6-.8-.5-.4.1-.6.4-.5.8.1.4.4.6.8.5.3-.1.6-.4.5-.8zm.3 3.2c-.1-.4-.4-.6-.8-.5-.4.1-.6.4-.5.8.1.4.4.6.8.5.4-.1.6-.5.5-.8zm-.7-6.3c-.1-.4-.4-.6-.8-.5-.4.1-.6.4-.5.8.1.4.4.6.8.5.4-.1.6-.4.5-.8zm-.3-3.1c-.1-.4-.4-.6-.8-.5-.4.1-.6.4-.5.8.1.4.4.6.8.5.4-.1.6-.5.5-.8zm-18.6-9.3c0 .4.3.7.7.7.4 0 .7-.3.7-.7 0-.4-.3-.7-.7-.7-.4.1-.7.4-.7.7zm-21.6-.3V14c.7-1.1 2.3-2.1 4-2.7 1.8-.6 3.5-.6 4.9-.1-.9.4-1.8 1-2.5 1.7-.9 1.1-1.5 2.5-1.3 3.9 0 .2.2.4.4.4s.4-.2.4-.4c-.2-2.5 2.1-4.7 4.3-5.1v-.1c0-.1-.1-.1-.1-.2-1.7-1.1-4-1.2-6.4-.4-1.1.4-2.2.9-3 1.5.7-2.1 1.1-4.3.7-6.2 4 .2 7.7 2.9 9.7 5.8-1 .6-2.3 1.5-3.3 3-.9 1.1-1.6 2.4-2 3.8-1.2-2.5-3.2-4.1-5.8-4.8zM9 30.4c.7 1.5 1.7 2.8 2.9 3.9h.1c.5.5 1 .9 1.5 1.2-1.7 1.3-3.9 2.1-6.2 2.2.3-1.1.3-2.4.1-3.6 1 1 2.4 1.8 4 1.8.3 0 .6 0 .9-.1.2 0 .4-.2.3-.5 0-.2-.2-.4-.5-.3-2.2.4-4-1-4.9-2.4.8-.4 1.4-1.2 1.8-2.2zm4.2 2.4c-.8-.8-1.6-1.8-2.2-2.9-.6-1.1-1-2.4-1.1-3.7.8 2.5 3.4 4.3 6.5 4.3h6.1l.6 5.1h-2.7c-1.8 0-3.4-.4-4.9-1.2-.8-.4-1.6-1-2.3-1.6zm9.4-21h3.7l2.6 23.8h-3.7l-2.6-23.8zM24 49h.7v-.7H24v.7zm0 1h6.3v-.4H24v.4zm0 .8h6.3v.1l.1.2c1 2.5 3.5 4 6.7 4 3-.1 5.5-1.5 6.4-3.7h5.3l-.1.2-1 1.9-1 1.5c-1.3 2.2-11.5 4-17.7 3.2-.1-.8-.1-1.6-.1-2.4v-3.5l-.2-.1c-1-.6-1.9-.5-2.8 0l-.2.1V57.2l-.2-.2c-.9-1.5-1.4-3.6-1.5-6.2zm2 14c.5.3 1.3.5 2 .4-.1.3-.2.7-.3 1-.4.1-.9.1-1.3 0-.3-.1-.6-.3-.7-.4.1-.3.2-.6.3-1zm2.1-.5c-.6.3-1.5.1-1.9-.3.1-.4.1-.7.2-1.1.5.3 1.2.4 1.9.3 0 .4-.1.8-.2 1.1zm.3-4.6v.9c-.7.1-1.4-.2-1.8-.4v-.8c.5.1 1.1.2 1.8.3zm-.2-2c0 .2 0 .5.1.7v.5c-.7 0-1.2-.2-1.7-.4v-.6-.3c.5.1 1 .2 1.6.1zM27 54.9h-.5v-2.3c.5-.3 1-.2 1.6 0v2.3H27zm1.2 2c-.6.1-1.1 0-1.6-.2v-1H28.2c-.1.4-.1.8 0 1.2zm.2 5.5c-.7.2-1.6-.1-1.9-.4 0-.3.1-.7.1-1 .5.3 1.2.4 1.9.4-.1.3-.1.7-.1 1zm19.2-11.7h.7V50h-.7v.7zm-.2-15.1l-.6-5.1h6.6c2.3 0 4.3-1.2 5.3-3-1.1 4.6-5.3 8.1-10.3 8.1h-1zm11.4-15.7c-1-1.8-3-3-5.3-3h-8.2l-.6-5.1h3.7c5 0 9.3 3.5 10.4 8.1zm-16.1-8.1l2.7 23.8h-3.7l-.6-5.1-.2-1.9L39 11.8h3.7zm-2.2-2h-4.1V6.5l4.1 3.3zM28.3 23.3l-.6-5.6h11.2l.6 5.4v.2H28.3zm.8 6.4l-.6-5.6h11.1l.6 5.6H29.1zm.6 19.3h.7v-.7h-.7v.7zm0-13.4l-.6-5.1h11.1l.6 5.1H29.7zM46 23.3l-.6-5.6h8.1c2.9 0 5.2 2.3 5.2 5.1v.5H46zm12.7.8v.6c0 2.8-2.4 5.1-5.2 5.1h-6.7l-.6-5.6h12.5zm-13 26.6h.7V50h-.7v.7zm-1.9 0h.7V50h-.7v.7zm-.7-1.4l-1.3-11.6h3.7l1.3 11.6h-3.7zm-1.6 1.3c-.5 1.4-2.3 2.3-4.5 2.3-1.7 0-3.9-.6-4.7-2.5v-2.9H31l-1.1-9.9H41l1.3 11.6h-.7l-.1 1.4zM27.8 49h.7v-.7h-.7v.7zm-1.9 0h.7v-.7h-.7v.7zm-.5-11.3h3.7l1.1 9.9h-3.8l-1-9.9zm12.8-25.9l.6 5.1H27.6l-.6-5.1h8.7c.1 0 .1.1.2.1s.2 0 .2-.1h2.1zm-2.6-2h-.5l-2.8-1.6 3.4-1.8v3.4zm-1.2-3.7l-3 1.7-2.9-1.7h5.9zm-3 2.5l2 1.2h-4.2l2.2-1.2zm-3.2.9V6.8l2.4 1.4-2.4 1.3zm-.8 0L25 8.2l2.3-1.4v2.7zM27 6.1l-2.8 1.7-3-1.7H27zm-6.3.6l2.7 1.5-2.7 1.6V6.7zM10.5 23.3v-.5c0-2.8 2.7-5.1 6-5.1h4.7l.6 5.6H10.5zM22.3 9.8l1.9-1.1 2.1 1.1h-4zm.2 19.9h-6.1c-3.3 0-6-2.3-6-5.1V24h11.4l.7 5.7zm-2-17.9l.6 5.1h-4.7c-2.8 0-5.1 1.4-6.2 3.5.4-1.8 1-3.3 1.9-4.6.9-1.1 2-2.1 3.3-2.8.1 0 .2-.1.2-.1.1 0 .1-.1.2-.1l4.7-1zm-.6-2L18 8.9 19.9 7v2.8zm-.3-3.6l-2.4 2.4L13.5 7l6.1-.8zm-2.2 3.4l1 .4c-.6.1-1.3.3-1.9.5l.9-.9zm-2 .8c-.7-.9-1.5-1.9-2.5-2.7l3.7 1.6-1.2 1.1zm7.2 44.7l-2.4-.9L22 52c.1 1.1.3 2.2.6 3.1zm-.6-4.3l-2.4 2.9-1.5-2.9H22zm-4.7.2l1.3 2.5-2.8-1.1 1.5-1.4zm-.9-.2L15.2 52l-.8-1.2h2zm-2.3 1l-.5-.2V51l.5.8zm-1.6-.4h.1v-.6h-.1v.6zm-.8 6.6l-.1.1c-.1 0-.3-.2-.3-.7l.3-2.5c.1.8.2 1.6.2 2.5.1.3 0 .5-.1.6zm.2-13.3c-.1.9-.1 1.8-.2 2.5l-.3-2.5c0-.5.2-.7.3-.7 0 0 .1 0 .1.1s.1.3.1.6zm49.2-22.2c.5.3.9.7.9 1.3 0 .5-.4 1-.9 1.3v-2.6zM35.6 2.9h-4.3l.8-.7c.1-.1.1-.2.1-.3s0-.2-.1-.3l-.8-.7h4.3v2zM.1 15.1c.1.3.4.5.7.6 3.8.7 6.6 3.5 7 7v3.2c0 2.2-.5 4.9-2.7 5.8-.3.1-.5.4-.6.7-.1.3 0 .6.1.9 1 1.4.9 3.7.2 5.3-.1.3-.1.7.1.9.2.3.5.5.8.5h.7c3.4 0 6.7-1.2 8.9-3.3 1.6.7 3.3 1.1 5.1 1.1h2.9l1.1 9.9H22V50H12.2c.1-.8.1-1.5.2-2.2.1-.9.2-1.9.3-3 0-.7-.2-1-.4-1.2-.2-.2-.4-.3-.7-.3-.6 0-1.1.5-1.1 1.5l.7 5.1-.8 1.3.8 1.2-.7 5c0 1 .6 1.5 1.1 1.5.3 0 .5-.1.7-.3.2-.2.4-.6.4-1.2-.1-1.2-.2-2.1-.3-3.1-.1-.7-.1-1.3-.2-2.1h.8l1.9.7s.1 0 .1.1l4.2 1.7c.1.1.1.1.2.1l3.4 1.3c.3.7.6 1.3.9 1.8.4.6 1 1.1 2 1.5v1c0 .6 0 1.1-.1 1.7v.1l-.3 1.8v.1c-.1.5-.3 1-.5 1.4v.1c-.3.6-.7 1.2-1.3 1.6-.2.1-.2.4 0 .6.1.2.4.2.6 0 .5-.4.9-.9 1.2-1.4.2.2.5.3.8.4.4.2.8.2 1.2.2-.2.5-.5 1.1-.8 1.7-.1.2 0 .4.2.5.1 0 .1.1.2.1s.3-.1.4-.2c2-3.5 2.2-6.4 2-9 .9.1 2 .2 3.1.2 6.3 0 14.5-1.6 16.2-4.4l1.9-3.5 12-4v-2.1L49 49.1l-1.3-11.5h.8c6.7 0 12.2-5.2 12.6-11.8 1-.3 1.8-1.2 1.8-2.1 0-1-.7-1.8-1.8-2.1-.5-6.6-6-11.8-12.7-11.8h-6.6l-5.4-4.3V.4c0-.2-.2-.4-.4-.4h-5.7c-.1 0-.3.1-.3.3-.1.2 0 .3.1.4l1.2 1.1L30.1 3c-.1.1-.2.3-.1.4.1.2.2.3.4.3h5.3v1.6H20.5l-9 1.2C9.2 4.9 6.6 3.8 3.7 3.8c-.4 0-.7 0-1.1.1-.3 0-.6.2-.7.5-.2.2-.2.6-.1.9.9 1.9.1 6-1.7 8.9-.1.3-.1.6 0 .9zm25 8.7c0 .4.3.7.7.7.4 0 .7-.3.7-.7s-.3-.7-.7-.7c-.4 0-.7.3-.7.7zM57.7 45c-1.1 0-1.9.6-2.5 1.5-.5-.4-1.1-.6-1.7-.6-.9 0-1.7.4-2.3 1L50 39.1l7.7 5.9zm2.6 1.5c.1-.2.1-.4-.1-.6-.1-.1-.2-.1-.3-.2l-10.3-7.9c-.1-.1-.3-.1-.5 0-.1.1-.2.2-.2.4l1.4 9.9c0 .2.2.3.4.3h.1c.2 0 .3-.1.4-.2.4-.9 1.3-1.5 2.2-1.5.4 0 1 .1 1.5.7.1.1.2.2.4.1.1 0 .3-.1.3-.3.4-1 1.1-1.6 2.1-1.6.6 0 1.2.2 1.7.6l.2.2c.3.3.6.3.7.1zM24.4 17.6c0 .4.3.7.7.7.4 0 .7-.3.7-.7 0-.4-.3-.7-.7-.7-.4 0-.7.3-.7.7zm.4 3.1c0 .4.3.7.7.7.4 0 .7-.3.7-.7s-.4-.7-.8-.7c-.3 0-.6.3-.6.7z";
const SHIP_PATH = new Path2D(SHIP_SVG);
const SCALE = 0.65;
const OFFSET = 80;

//canvas draw function
function draw(ctx, location) {
  ctx.fillStyle = "#FF2A13";
  ctx.shadowColor = "#ff7869";
  ctx.shadowBlur = 20;
  ctx.save();
  ctx.scale(SCALE, SCALE);
  ctx.translate(location.x / SCALE - OFFSET, location.y / SCALE - OFFSET);
  ctx.fill(SHIP_PATH);
  ctx.restore();
}

const StyledBody = styled.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  font-size: 1rem;
`;

const StyledBtn = styled.button`
  background: #ff2a13;
  color: #fff;
  padding: 10px;
  margin: 5px;
  width: 150px;
  border: none;
  border-radius: 10px;
  box-sizing: border-box;
  font-size: inherit;

  &:focus {
    outline: none;
  }

  &:hover {
    background-color: white;
    border: 1px solid #ff2a13;
    color: black;
  }
`;
function Airship() {
  //keep track of locations, initial state is an empty array
  const [locations, setLocations] = React.useState([]);
  const canvasRef = React.useRef(null);

  //every render clears canvas and redraws all locations
  useEffect(() => {
    const canvas = canvasRef.current;
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
    locations.forEach(location => draw(ctx, location));
  });

  function handleClear() {
    setLocations([]);
  }

  return (
    <StyledBody>
      <StyledBtn onClick={handleClear}>Clear</StyledBtn>
      <canvas
        ref={canvasRef}
        width={window.innerWidth}
        height={window.innerHeight / 2}
        onClick={e => {
          const newLocation = { x: e.clientX, y: e.clientY };
          setLocations([...locations, newLocation]);
          {
            console.log(locations);
          }
        }}
      />
    </StyledBody>
  );
}

export default Airship;
